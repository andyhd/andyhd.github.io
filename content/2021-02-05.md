Title: Custom Django Migration Operations
Date: 2021-02-05 15:52
Friendly_Date: on a surprisingly sunny Friday afternoon
Summary: I fixed a migration issue with a little documented feature
Status: draft

## The Problem

Changed DateTimeRangeField to DateRangeField in models

Autogenerated migration with `manage.py makemigrations`

Tried to run migration and got an error
```text
django.db.utils.ProgrammingError: cannot cast type tstzrange to daterange
```

## The Solution

1. Create a placeholder `daterange` column
2. Copy the data from the existing `tstzrange` column to the placeholder column
3. Remove original column
4. Rename placeholder to previously existing column name


## The Implementation

You could do this with `RunSQL`, but since I have to make the same change to
fields in a lot of different tables it would mean a lot of copy-pasting.

I need to migrate both the database schema and the data, to avoid losing the
important parts of the data.

So I need to write a custom migration `Operation` class. There isn't much
information about this.


